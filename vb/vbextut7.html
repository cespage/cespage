<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>CESPage.com Visual Basic - Tutorials - Lucky Dice</title>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=iso-8859-1" />
<meta name="description" content="CESPage.com Visual Basic - Visual Basic Resources, Tutorials, Downloads and more" />
<meta name="keywords" content="CES, ces, cespage, CESPage, CESPage.com, cespage.com, visual basic ,Visual Basic, VB, vb, Peter Bull, peter bull, downloads, download, tutorials, tutorial, text, lottery, drawing, task tray, .net, .NET, examples, news, books, articles, source code, projects, components, forums, tips, 2005" />
<link rel="stylesheet" type="text/css" href="default.css" />
<link rel="meta" href="http://www.cespage.com/labels.rdf" type="application/rdf+xml" title="ICRA labels" />
</head>
<body>
<div id="main">
<div id="header">
<a href="index.html"><img src="images/header.jpg" height="50" width="412" alt="CESPage.com Visual Basic" /></a>
</div>
<div id="titlebar">
<h1>Lucky Dice</h1>
</div>
<div id="container">
<div class="navbar">
<div class="navbar-element"><a href="index.html" class="navbar-link">Home</a></div>
<div class="navbar-element"><a href="articles.html" class="navbar-link">Articles</a></div>
<div class="navbar-selected"><a href="tutorials.html" class="navbar-link">Tutorials</a></div>
<div class="navbar-element"><a href="downloads.html" class="navbar-link">Downloads</a></div>
<div class="navbar-element"><a href="books.html" class="navbar-link">Books</a></div>
<div class="navbar-element"><a href="weblinks.html" class="navbar-link">Weblinks</a></div>
<div class="navbar-element"><img src="images/div160x1.gif" width="160" height="1" alt="-" /></div>
<div class="navbar-element"><a href="http://www.cespage.com" class="navbar-link">CESPage.com</a></div>
</div>
<div id="content">
<p>This is a simple game, which will introduce you to Methods, Multiple Picture Boxes, Labels, Random Numbers, Drawing and more!
</p>
<p>
<em class="icon-print"><a href="tutorials/vbextut7.html">Printer Friendly</a></em>
<em class="icon-dload"><a href="tutorials/vbextut7.zip">Download Tutorial</a> (227KB)</em>
<em class="icon-dload"><a href="tutorials/vbextut7code.zip">Download Source Code</a> (15KB)</em>
</p>
<p class="tutorial-step">Step 1</p>
<p>
Start Microsoft Visual Basic 2005 Express Edition, then select File then New Project... Choose Windows Application from the 
New Project Window, enter a name for the Project and then click OK, see below:
</p>
<div class="tutorial-image">
<img src="tutorials/vbexnewproject.gif" width="681" height="417" alt="New Project" />
</div>
<p class="tutorial-step">Step 2</p>
<p>
A Blank Form named Form1 should then appear, see below:
</p>
<div class="tutorial-image">
<img src="tutorials/vbexform1.gif" width="307" height="307" alt="Form1" />
</div>
<p class="tutorial-step">Step 3</p>
<p>
Then from the Windows Forms components tab select the PictureBox control:
</p>
<div class="tutorial-image">
<img src="tutorials/vbexpicturebox.gif" width="248" height="398" alt="PictureBox Component" />
</div>
<p class="tutorial-step">Step 4</p>
<p>
Draw two PictureBoxes on the Form, see below:
</p>
<div class="tutorial-image">
<img src="tutorials/vbexform1pics.gif" width="307" height="307" alt="Form1 with two PictureBoxes" />
</div>
<p class="tutorial-step">Step 5</p>
<p>
Select PictureBox1 and then go to the Properties box and change the BackColor property from Control to White, see below:
</p>
<div class="tutorial-image">
<img src="tutorials/vbexpictureprop.gif" width="202" height="457" alt="PictureBox Properties" />
</div>
<p class="tutorial-step">Step 6</p>
<p>
Select PictureBox2 and then go to the Properties box and change the BackColor property from Control to White, so the form appears as below:
</p>
<div class="tutorial-image">
<img src="tutorials/vbexform1pic1and2.gif" width="307" height="307" alt="Form1 with White PictureBoxes" />
</div>
<p class="tutorial-step">Step 7</p>
<p>
Then from the Windows Forms components tab select the Button control:
</p>
<div class="tutorial-image">
<img src="tutorials/vbexbutton.gif" width="248" height="398" alt="Button Component" />
</div>
<p class="tutorial-step">Step 8</p>
<p>
Draw three Buttons on the Form, see below:
</p>
<div class="tutorial-image">
<img src="tutorials/vbexform1dicebtns.gif" width="307" height="307" alt="Form1 with PictureBoxes and Three Buttons" />
</div>
<p class="tutorial-step">Step 9</p>
<p>
Click on Button1 and then go to the Properties box and change the Text Property to Roll, see below:
</p>
<div class="tutorial-image">
<img src="tutorials/vbexdicebtn1prop.gif" width="202" height="457" alt="Button1 Property" />
</div>
<p class="tutorial-step">Step 10</p>
<p>
Click on Button2, change its Text Property to New Game, click on Button3 and change its Text Property to Exit until the form is as below:
</p>
<div class="tutorial-image">
<img src="tutorials/vbexform1diceose.gif" width="307" height="307" alt="Form1 Dice Buttons" />
</div>
<p class="tutorial-step">Step 11</p>
<p>
Then from the Windows Forms components tab select the Label control:
</p>
<div class="tutorial-image">
<img src="tutorials/vbexlabel.gif" width="248" height="398" alt="Label Component" />
</div>
<p class="tutorial-step">Step 12</p>
<p>
Draw a Label on the Form, see below:
</p>
<div class="tutorial-image">
<img src="tutorials/vbexform1dicelbl.gif" width="300" height="300" alt="Form1 with Label Buttons and PictureBoxes" />
</div>
<p class="tutorial-step">Step 13</p>
<p>
Right click on the Form and select the view Code option then in the code view type in below Public Class Form1 the following:
</p>
<blockquote>
<pre class="tut-code">
<span class="tut-rsvd">Private</span> DrawBitmap <span class="tut-rsvd">As</span> Bitmap
<span class="tut-rsvd">Private</span> DrawGraphics <span class="tut-rsvd">As</span> Graphics
<span class="tut-rsvd">Private</span> Turn <span class="tut-rsvd">As Integer</span>
</pre>
</blockquote>
<p>
See Below:
</p>
<div class="tutorial-image">
<img src="tutorials/vbexdicedecs.gif" width="310" height="119" alt="Dice Declarations" />
</div>
<p class="tutorial-step">Step 14</p>
<p>
Double Click on Form1 and type in the Form1_Load Sub:
</p>
<blockquote>
<pre class="tut-code">
Button2.PerformClick()
</pre>
</blockquote>
<p>
See Below:
</p>
<div class="tutorial-image">
<img src="tutorials/vbexdiceload.gif" width="490" height="90" alt="Form1 Load" />
</div>
<p class="tutorial-step">Step 15</p>
<p>
Right click on the Form and select the view Code option then in the code view type in below the end of the Form1_Load sub (after end sub):
</p>
<blockquote>
<pre class="tut-code">
<span class="tut-rsvd">Private Sub</span> DiceTopLeft()
  DrawGraphics.FillEllipse(Brushes.Black, _
  6, 6, 12, 12)
<span class="tut-rsvd">End Sub</span>

<span class="tut-rsvd">Private Sub</span> DiceTopRight()
  DrawGraphics.FillEllipse(Brushes.Black, _
  DrawBitmap.Width - 18, 6, 12, 12)
<span class="tut-rsvd">End Sub</span>

<span class="tut-rsvd">Private Sub</span> DiceCentreLeft()
  DrawGraphics.FillEllipse(Brushes.Black, _
  6, <span class="tut-rsvd">CInt</span>(DrawBitmap.Height / 2 - 6), 12, 12)
<span class="tut-rsvd">End Sub</span>

<span class="tut-rsvd">Private Sub</span> DiceCentre()
  DrawGraphics.FillEllipse(Brushes.Black, _
  <span class="tut-rsvd">CInt</span>(DrawBitmap.Width / 2 - 6), _
  <span class="tut-rsvd">CInt</span>(DrawBitmap.Height / 2 - 6), 12, 12)
<span class="tut-rsvd">End Sub</span>

<span class="tut-rsvd">Private Sub</span> DiceCentreRight()
  DrawGraphics.FillEllipse(Brushes.Black, _
  DrawBitmap.Width - 18, _
  <span class="tut-rsvd">CInt</span>(DrawBitmap.Height / 2 - 6), 12, 12)
<span class="tut-rsvd">End Sub</span>

<span class="tut-rsvd">Private Sub</span> DiceBottomLeft()
  DrawGraphics.FillEllipse(Brushes.Black, _
  6, DrawBitmap.Height - 18, 12, 12)
<span class="tut-rsvd">End Sub</span>

<span class="tut-rsvd">Private Sub</span> DiceBottomRight()
  DrawGraphics.FillEllipse(Brushes.Black, _
  DrawBitmap.Width - 18, DrawBitmap.Height - 18, 12, 12)
<span class="tut-rsvd">End Sub</span>
</pre>
</blockquote>
<p>
See Below:
</p>
<div class="tutorial-image">
<img src="tutorials/vbexdicedots.gif" width="512" height="650" alt="Dice Dots Methods" />
</div>
<p class="tutorial-step">Step 16</p>
<p>
While still in the code view add the following below the end of the BottomRight(...) sub ,after the "end sub":
</p>
<blockquote>
<pre class="tut-code">
<span class="tut-rsvd">Private Sub</span> DiceDraw(<span class="tut-rsvd">ByVal</span> Value <span class="tut-rsvd">As Integer</span>)
  DrawGraphics.SmoothingMode = Drawing2D.SmoothingMode.HighQuality
  <span class="tut-rsvd">Select Case</span> (Value)
    <span class="tut-rsvd">Case</span> 1
      DiceCentre()
    <span class="tut-rsvd">Case</span> 2
      DiceTopLeft()
      DiceBottomRight()
    <span class="tut-rsvd">Case</span> 3
      DiceTopLeft()
      DiceCentre()
      DiceBottomRight()
    <span class="tut-rsvd">Case</span> 4
      DiceTopLeft()
      DiceBottomLeft()
      DiceTopRight()
      DiceBottomRight()
    <span class="tut-lvl2"><span class="tut-rsvd">Case</span> 5
      DiceTopLeft()
      DiceBottomLeft()
      DiceCentre()
      DiceTopRight()
      DiceBottomRight()
    <span class="tut-rsvd">Case</span> 6
      DiceTopLeft()
      DiceCentreLeft()
      DiceBottomLeft()
      DiceTopRight()
      DiceCentreRight()
      DiceBottomRight()
  <span class="tut-rsvd">End Select</span>
<span class="tut-rsvd">End Sub</span>
</pre>
</blockquote>
<p>
See Below:
</p>
<div class="tutorial-image">
<img src="tutorials/vbexdicerender.gif" width="595" height="552" alt="Render Dice Method" />
</div>
<p class="tutorial-step">Step 17</p>
<p>
Also in the code view add these routines for the Dice, below the one just entered, after the "end sub":
</p>
<blockquote>
<pre class="tut-code">
<span class="tut-rsvd">Private Sub</span> DiceOne(<span class="tut-rsvd">ByVal</span> Value <span class="tut-rsvd">As Integer</span>)
  DrawBitmap = <span class="tut-rsvd">New</span> Bitmap(PictureBox1.Width, PictureBox1.Height)
  DrawGraphics = Graphics.FromImage(DrawBitmap)
  DiceDraw(Value)
  PictureBox1.Image = DrawBitmap
<span class="tut-rsvd">End Sub</span>

<span class="tut-rsvd">Private Sub</span> DiceTwo(<span class="tut-rsvd">ByVal</span> Value <span class="tut-rsvd">As Integer</span>)
  DrawBitmap = <span class="tut-rsvd">New</span> Bitmap(PictureBox2.Width, PictureBox2.Height)
  DrawGraphics = Graphics.FromImage(DrawBitmap)
  DiceDraw(Value)
  PictureBox2.Image = DrawBitmap
<span class="tut-rsvd">End Sub</span>

<span class="tut-rsvd">Private Function</span> DiceValue() <span class="tut-rsvd">As Integer</span>
  Randomize()
  DiceValue = <span class="tut-rsvd">CInt</span>(Int((6 * Rnd()) + 1))
<span class="tut-rsvd">End Function</span>
</pre>
</blockquote>
<p>
See Below:
</p>
<div class="tutorial-image">
<img src="tutorials/vbexdiceroutines.gif" width="580" height="319" alt="Dice Routines" />
</div>
<p class="tutorial-step">Step 18</p>
<p>
Go to the Form [Design], Double Click on the Button Labeled Roll (Button1) and type in the Button1_Click() Sub:
</p>
<blockquote>
<pre class="tut-code">
<span class="tut-rsvd">If</span> Turn = 1 <span class="tut-rsvd">Then</span>
  DiceOne(DiceValue)
  Label1.Text = <span class="tut-valu">"Player One"</span>
  Turn = 2
<span class="tut-rsvd">Else</span>
  DiceTwo(DiceValue)
  Label1.Text = <span class="tut-valu">"Player Two"</span>
  Turn = 1
<span class="tut-rsvd">End If</span>
</pre>
</blockquote>
<p>
See Below:
</p>
<div class="tutorial-image">
<img src="tutorials/vbexrollclick.gif" width="512" height="212" alt="Button1 Click Event" />
</div>
<p class="tutorial-step">Step 19</p>
<p>
Double Click on the Button Labeled New Game (Button2) and type in the Button2_Click Sub:
</p>
<blockquote>
<pre class="tut-code">
PictureBox1.Image = <span class="tut-rsvd">Nothing</span>
PictureBox2.Image = <span class="tut-rsvd">Nothing</span>
Turn = 1
Label1.Text = <span class="tut-valu">"Player One"</span>
</pre>
</blockquote>
<p>
See Below:
</p>
<div class="tutorial-image">
<img src="tutorials/vbexnewgameclick.gif" width="512" height="128" alt="Button2 Click Event" />
</div>
<p class="tutorial-step">Step 20</p>
<p>
Double Click on the Button Labeled New Game (Button2) and type in the Button2_Click Sub:
</p>
<blockquote>
<pre class="tut-code">
<span class="tut-rsvd">End</span>
</pre>
</blockquote>
<p>
See Below:
</p>
<div class="tutorial-image">
<img src="tutorials/vbexbtn3click.gif" width="500" height="104" alt="Button3 Click Event" />
</div>
<p class="tutorial-step">Step 21</p>
<p>
Save the Project as you have now finished the application, then click on Start:
</p>
<div class="tutorial-image">
<img src="tutorials/vbexstart.gif" width="23" height="22" alt="Start" />
</div>
<p>
When you do the following will appear:
</p>
<div class="tutorial-image">
<img src="tutorials/vbexdicerun.gif" width="300" height="300" alt="Application Running" />
</div>
<p class="tutorial-step">Step 22</p>
<p>
Click on Roll to roll the dice for Player One by clicking on Roll, see below:
</p>
<div class="tutorial-image">
<img src="tutorials/vbexdice.gif" width="300" height="300" alt="Dice One Rolled" />
</div>
<p class="tutorial-step">Step 23</p>
<p>
Click on the Close button <img src="tutorials/vbexclose.gif" width="21" height="21" alt="Close" /> on the top right of Form1 to end the application.
</p>
<p>
By clicking on the Roll button it will alternate between Player One and Player Two (Left &amp; Right). You have just created a simple Dice Game, 
but what about scoring and proper dice rules, you'll have to wait, try and make it have a scoring system/rules yourself and see what else you 
can achieve with this simple program.
</p>
</div>
</div>
<div id="bottombar">
Copyright Comentsys &copy; 1997 - 2009, All rights reserved.&nbsp;<a href="about.html">About</a> | <a href="contact.html">Contact</a> | <a href="linktopage.html">Link to Page</a>
</div>
<div id="widgetbar">
<a href="http://validator.w3.org/check?uri=referer"><img src="images/xhtml.gif" height="15" width="90" alt="Valid XHTML 1.1!" /></a>
<a href="http://jigsaw.w3.org/css-validator/validator?uri=http://www.cespage.com/vb/default.css"><img src="images/css.gif" height="15" width="90" alt="Valid CSS" /></a>
<a href="http://www.w3.org/WAI/WCAG1AA-Conformance"><img src="images/waiaa.gif" height="15" width="110" alt="Level Double-A conformance icon, W3C-WAI Web Content Accessibility Guidelines 1.0" /></a>
<a href="http://www.icra.org"><img src="images/icra.gif" height="15" width="90" alt="This website is ICRA rated" /></a>
</div>
<div id="footer"><a href="http://www.comentsys.com"><img src="images/ceslogo.jpg" height="50" width="210" alt="Comentsys" /></a></div>
</div>
</body>
</html>
