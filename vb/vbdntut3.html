<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>CESPage.com Visual Basic - Tutorials - Task Tray</title>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=iso-8859-1" />
<meta name="description" content="CESPage.com Visual Basic - Visual Basic Resources, Tutorials, Downloads and more" />
<meta name="keywords" content="CES, ces, cespage, CESPage, CESPage.com, cespage.com, visual basic ,Visual Basic, VB, vb, Peter Bull, peter bull, downloads, download, tutorials, tutorial, text, lottery, drawing, task tray, .net, .NET, examples, news, books, articles, source code, projects, components, forums, tips, 2005" />
<link rel="stylesheet" type="text/css" href="default.css" />
<link rel="meta" href="http://www.cespage.com/labels.rdf" type="application/rdf+xml" title="ICRA labels" />
</head>
<body>
<div id="main">
<div id="header">
<a href="index.html"><img src="images/header.jpg" height="50" width="412" alt="CESPage.com Visual Basic" /></a>
</div>
<div id="titlebar">
<h1>Task Tray</h1>
</div>
<div id="container">
<div class="navbar">
<div class="navbar-element"><a href="index.html" class="navbar-link">Home</a></div>
<div class="navbar-element"><a href="articles.html" class="navbar-link">Articles</a></div>
<div class="navbar-selected"><a href="tutorials.html" class="navbar-link">Tutorials</a></div>
<div class="navbar-element"><a href="downloads.html" class="navbar-link">Downloads</a></div>
<div class="navbar-element"><a href="books.html" class="navbar-link">Books</a></div>
<div class="navbar-element"><a href="weblinks.html" class="navbar-link">Weblinks</a></div>
<div class="navbar-element"><img src="images/div160x1.gif" width="160" height="1" alt="-" /></div>
<div class="navbar-element"><a href="http://www.cespage.com" class="navbar-link">CESPage.com</a></div>
</div>
<div id="content">
<p>This will show you how to put an Icon in the Task Tray and make a Menu appear when you right click on the Icon in the Task Tray.</p>
<p>
<em class="icon-print"><a href="tutorials/vbdntut3.html">Printer Friendly</a></em>
<em class="icon-dload"><a href="tutorials/vbdntut3.zip">Download Tutorial</a> (75.2KB)</em>
<em class="icon-dload"><a href="tutorials/vbdntut3code.zip">Download Source Code</a> (13.3KB)</em>
</p>
<p class="tutorial-step">Step 1</p>
<p>
Load Microsoft Visual Studio.NET then select Visual Basic Projects, Windows Application, enter a name for the Project and then click OK, see below:
</p>
<div class="tutorial-image">
<img src="tutorials/imgnewproject.gif" width="531" height="371" alt="New Project" />
</div>
<p class="tutorial-step">Step 2</p>
<p>
A Blank Form named Form1 should then appear, see below:
</p>
<div class="tutorial-image">
<img src="tutorials/imgform1.gif" width="314" height="314" alt="Form1" />
</div>
<p class="tutorial-step">Step 3</p>
<p>
Scroll down the Windows Forms Components tab and select the NotifyIcon control:
</p>
<div class="tutorial-image">
<img src="tutorials/imgnotifyicon.gif" width="200" height="400" alt="NotifyIcon Control"/>
</div>
<p class="tutorial-step">Step 4</p>
<p>
Draw the NotifyIcon control on Form1 and it will appear in the pane, beneath the form, see below:
</p>
<div class="tutorial-image">
<img src="tutorials/imgpaneni.gif" width="200" height="84" alt="NotifyIcon Control in Pane" />
</div>
<p class="tutorial-step">Step 5</p>
<p>
Scroll down the Windows Forms Components tab and select the ContextMenu control:
</p>
<div class="tutorial-image">
<img src="tutorials/imgcontextmenu.gif" width="200" height="356" alt="ContextMenu Control" />
</div>
<p class="tutorial-step">Step 6</p>
<p>
Draw the ContextMenu control on the form, see below:
</p>
<div class="tutorial-image">
<img src="tutorials/imgformctx.gif" width="300" height="321" alt="Form with ContextMenu" />
</div>
<p class="tutorial-step">Step 7</p>
<p>
Make sure the ContextMenu1 control is selected in the Pane beneath the form then Click on the ContextMenu at the top of Form1 
and change Type Here to Exit by clicking on the text and typing in the new value, see below:
</p>
<div class="tutorial-image">
<img src="tutorials/imgform1ctxmnu.gif" width="300" height="321" alt="Form with ContextMenu with Exit" />
</div>
<p class="tutorial-step">Step 8</p>
<p>
Double click where you entered Exit on the ContextMenu and enter in the MenuItem1_Click sub:
</p>
<blockquote>
<pre class="tut-code">
<span class="tut-rsvd">End</span>
</pre>
</blockquote>
<p>
See Below:
</p>
<div class="tutorial-image">
<img src="tutorials/imgctxclick.gif" width="530" height="64" alt="ContextMenu MenuItem Click Event" />
</div>
<p class="tutorial-step">Step 9</p>
<p>
Click on the NotifyIcon1 control in the Pane beneath Form1, then go to the Properties box and set the ContextMenu property to ContextMenu1, see below:
</p>
<div class="tutorial-image">
<img src="tutorials/imgnotifyprop.gif" width="204" height="433" alt="NotifyIcon Properties" />
</div>
<p class="tutorial-step">Step 10</p>
<p>
Double Click on Form1 and type in the Form1_Load Sub:
</p>
<blockquote>
<pre class="tut-code">
NotifyIcon1.Icon = <span class="tut-rsvd">Me</span>.Icon
NotifyIcon1.Visible = <span class="tut-rsvd">True</span>
NotifyIcon1.Text = "Task Tray"
</pre>
</blockquote>
<p>
See Below:
</p>
<div class="tutorial-image">
<img src="tutorials/imgfrmclick.gif" width="530" height="100" alt="Form1 Load Event" />
</div>
<p class="tutorial-step">Step 11</p>
<p>
Save the Project as you have now finished the application, select Release and Click on Start:
</p>
<div class="tutorial-image">
<img src="tutorials/imgstart.gif" width="124" height="22" alt="Start (Release)" />
</div>
<p>
When you do the following will appear:
</p>
<div class="tutorial-image">
<img src="tutorials/imgtasktrayrun.gif" width="90" height="34" alt="Application Running" />
</div>
<p class="tutorial-step">Step 12</p>
<p>
Now right click on the icon shown in the Task Tray and a menu should appear, see below:
</p>
<div class="tutorial-image">
<img src="tutorials/imgtasktray.gif" width="120" height="36" alt="Task Tray with Menu" />
</div>
<p class="tutorial-step">Step 13</p>
<p>
Click on Exit on the menu to end the application. Try Changing the Form Icon or add other Sub Menus to the ContextMenu and see what happens!
</p>
</div>
</div>
<div id="bottombar">
Copyright Comentsys &copy; 1997 - 2009, All rights reserved.&nbsp;<a href="about.html">About</a> | <a href="contact.html">Contact</a> | <a href="linktopage.html">Link to Page</a>
</div>
<div id="widgetbar">
<a href="http://validator.w3.org/check?uri=referer"><img src="images/xhtml.gif" height="15" width="90" alt="Valid XHTML 1.1!" /></a>
<a href="http://jigsaw.w3.org/css-validator/validator?uri=http://www.cespage.com/vb/default.css"><img src="images/css.gif" height="15" width="90" alt="Valid CSS" /></a>
<a href="http://www.w3.org/WAI/WCAG1AA-Conformance"><img src="images/waiaa.gif" height="15" width="110" alt="Level Double-A conformance icon, W3C-WAI Web Content Accessibility Guidelines 1.0" /></a>
<a href="http://www.icra.org"><img src="images/icra.gif" height="15" width="90" alt="This website is ICRA rated" /></a>
</div>
<div id="footer"><a href="http://www.comentsys.com"><img src="images/ceslogo.jpg" height="50" width="210" alt="Comentsys" /></a></div>
</div>
</body>
</html>
